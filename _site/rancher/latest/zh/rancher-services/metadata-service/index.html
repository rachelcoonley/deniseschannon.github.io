<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Metadata Service in Rancher</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Documentation for Rancher">
    <link href="/docs/favicon.png" rel="shortcut icon" type="image/png" sizes="16x16">
    <link href="/docs/css/syntax.css?t=2017-12-04 13:23:19 -0800" rel="stylesheet">
    <link href="/docs/vendor/font-awesome/css/font-awesome.min.css?t=2017-12-04 13:23:19 -0800" rel="stylesheet">
    <link href="/docs/vendor/lato/lato.css?t=2017-12-04 13:23:19 -0800" rel="stylesheet">
    <link href="/docs/css/lacsso.css?t=2017-12-04 13:23:19 -0800" rel="stylesheet">
    <link href="/docs/css/slicknav.css?t=2017-12-04 13:23:19 -0800" rel="stylesheet">
    <link href="/docs/css/rancher-docs.css?t=2017-12-04 13:23:19 -0800" rel="stylesheet">
</head>

<body class="bg-default">
    <div class="row body">
    <header class="page-header">
      <div class="wrap clearfix">
        <nav role="navigation" id="js-responsive-nav" class="clearfix responsive-nav"><a class="nav-toggle"></a>
          <a class="nav-logo logo-caas btn bg-transparent"><img src="/docs/img/rancher-logo-nopadding.svg" class="img-responsive" alt="Rancher" data-pin-nopin="true"></a>
          <ul class="nav-main nav-list">
            <li><a href="http://rancher.com/">Back to Rancher.com</a></li>

            <ul class="nav navbar-nav pull-right">
              <li><a href="https://github.com/rancher/rancher#installation" id="rnchrdm-nav-download" title="Download Rancher" target="_blank"><img src="/docs/img/header-download.svg" alt="Download Rancher" height="12" width="14"> Download Rancher</a></li>
              <li><a href="http://rancher.com/support" id="rnchrdm-nav-reqsupport" title="Request Support"><i class="fa fa-question-circle" aria-hidden="true"></i>
 Request Support</a></li>
            </ul>
          </ul>
      </nav>
    </div>
    <h1>Rancher Docs</h1>
  </header>
  <div class="clearfix"></div>
  <div class="wrap clearfix">
        <div class="col span-3 mt-0 mr-0 sidebar">
        <!--Start Google Search-->
              <div class="gcse-search" id="google-search"></div>
              <script>
              var match = window.location.pathname.match(/\/rancher\/([^\/]+)/);
              if (match) {
                  document.getElementById('google-search').setAttribute('data-defaultToRefinement', match[1]);
              }

              (function() {
                  var cx = '007896692384436596364:60akf3bfmxm';
                  var gcse = document.createElement('script');
                  gcse.type = 'text/javascript';
                  gcse.async = true;
                  gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                  var s = document.getElementsByTagName('script')[0];
                  s.parentNode.insertBefore(gcse, s);
              })();
              </script>
              <!--End Google Search-->

<ul id="menu">
    <li><a href="/docs/rancher/v1.6/zh/">简介</a></li>
    <li><a href="/docs/rancher/v1.6/zh/quick-start-guide/">快速开始</a></li>
    <li>
        <a href="#">安装Rancher<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
          <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/">安装 Rancher Server</a></li>
          <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/#安装需求">安装需求</a></li>
          <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/#rancher-server-标签">Rancher Server标签</a></li>
          <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/#启动-rancher-server---单容器部署-non-ha">启动 Rancher Server - 单容器部署</a></li>
          <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/#启动-rancher-server---多节点的ha部署">启动 Rancher Server - 多节点的HA部署</a></li>
          <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/#ha部署需求">HA部署需求</a></li>
          <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/#启动-rancher-server---单容器部署---使用外部数据库">启动 Rancher Server - 单容器部署 - 使用外部数据库</a></li>
          <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/#启动-rancher-server---单容器部署---挂载mysql数据库的数据目录">启动 Rancher Server - 单容器部署 - 挂载MYSQL数据库的数据目录</a></li>
          <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/#使用aws的elasticclassic-load-balancer作为rancher-server-ha的负载均衡器">使用AWS的ELB作为HA的负载均衡器</a></li>
          <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/#tls认证使用adopenldap">使用TLS认证的AD/OPENLDAP</a></li>
          <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/#在http代理后方启动-rancher-server">在HTTP代理后启动 Rancher Server</a></li>
          <li><a href="/docs/rancher/v1.6/zh/installing-rancher/selinux/">在SELinux模式下使用Rancher</a></li>
          <li>
               <a href="#">安装Rancher并使用SSL<i class="pull-right fa fa-angle-down"></i></a>
               <ul>
                 <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/basic-ssl-config/#需求">需求</a></li>
                 <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/basic-ssl-config/#nginx-配置模版">NGINX配置示例</a></li>
                 <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/basic-ssl-config/#apache-配置例子">Apache配置示例</a></li>
                 <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/basic-ssl-config/#haproxy-配置例子">HAProxy配置示例</a></li>
                 <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/basic-ssl-config/#使用aws的elastic-load-balancer作为rancher-server-ha的负载均衡器并使用ssl">使用AWS的ELB作为HA的负载均衡器并使用SSL</a></li>
                 <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/basic-ssl-config/#f5-big-ip配置示例">F5 BIG-IP配置示例</a></li>
                 <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/basic-ssl-config/#使用自签名证书-beta">使用自签名证书</a></li>
               </ul>
          </li>
          <li>
               <a href="#">内网启动Rancher<i class="pull-right fa fa-angle-down"></i></a>
               <ul>
                 <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/no-internet-access/#使用私有镜像仓库">使用私有镜像仓库</a></li>
                 <li><a href="/docs/rancher/v1.6/zh/installing-rancher/installing-server/no-internet-access/#使用http代理">使用HTTP代理</a></li>
               </ul>
          </li>
        </ul>
    </li>
    <li>
         <a href="#">升级Rancher Server<i class="pull-right fa fa-angle-down"></i></a>
         <ul>
           <li><a href="/docs/rancher/v1.6/zh/upgrading/">升级Rancher Server</a></li>
           <li><a href="/docs/rancher/v1.6/zh/upgrading/#rancher-server-tags">Rancher Server标签</a></li>
           <li><a href="/docs/rancher/v1.6/zh/upgrading/#基础设施服务]">升级基础设施服务</a></li>
           <li><a href="/docs/rancher/v1.6/zh/upgrading/#升级ha架构">升级HA架构的Rancher Server</a></li>
           <li><a href="/docs/rancher/v1.6/zh/upgrading/#单独升级一个容器non-ha---外部数据库">升级非HA模式的Rancher Server - 外部数据库</a></li>
           <li><a href="/docs/rancher/v1.6/zh/upgrading/#单独升级一个容器non-ha---绑定挂载的mysql卷">升级非HA模式的Rancher Server - 绑定挂载的MYSQL卷</a></li>
           <li><a href="/docs/rancher/v1.6/zh/upgrading/#没有互联网访问的rancher服务器">升级内网中的Rancher Server</a></li>
        </ul>
     </li>
    <li>
         <a href="#">系统设置<i class="pull-right fa fa-angle-down"></i></a>
         <ul>
           <li>
                <a href="#">访问控制方式<i class="pull-right fa fa-angle-down"></i></a>
                <ul>
                  <li><a href="/docs/rancher/v1.6/zh/configuration/access-control/#活动目录">Active Directory</a></li>
                  <li><a href="/docs/rancher/v1.6/zh/configuration/access-control/#azure-ad">Azure AD</a></li>
                  <li><a href="/docs/rancher/v1.6/zh/configuration/access-control/#github">Github</a></li>
                  <li><a href="/docs/rancher/v1.6/zh/configuration/access-control/#本地身份认证">本地身份认证</a></li>
                  <li><a href="/docs/rancher/v1.6/zh/configuration/access-control/#openldap">OpenLDAP</a></li>
                  <li><a href="/docs/rancher/v1.6/zh/configuration/access-control/#shibboleth">Shibboleth</a></li>
                </ul>
          </li>
          <li><a href="/docs/rancher/v1.6/zh/configuration/access-control/#访问控制">访问控制</a></li>
          <li><a href="/docs/rancher/v1.6/zh/configuration/access-control/#限制并发登陆">限制并发登陆</a></li>
          <li><a href="/docs/rancher/v1.6/zh/configuration/accounts/">账户</a></li>
          <li><a href="/docs/rancher/v1.6/zh/configuration/settings/#主机注册">注册主机</a></li>
          <li><a href="/docs/rancher/v1.6/zh/configuration/settings/#应用商店">应用商店</a></li>
          <li><a href="/docs/rancher/v1.6/zh/configuration/machine-drivers/">主机驱动</a></li>
        </ul>
    </li>
    <li>
          <a href="#">环境<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
            <li><a href="/docs/rancher/v1.6/zh/environments/">环境管理</a></li>
            <li><a href="/docs/rancher/v1.6/zh/environments/#什么是环境模版">环境模版</a></li>
            <li><a href="/docs/rancher/v1.6/zh/environments/#成员角色">环境中的角色</a></li>
          </ul>
    </li>
    <li>
        <a href="#">主机<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
          <li><a href="/docs/rancher/v1.6/zh/hosts/">主机简介</a></li>
          <li><a href="/docs/rancher/v1.6/zh/hosts/#docker版本适用对比">支持的Docker版本</a></li>
          <li><a href="/docs/rancher/v1.6/zh/hosts/#主机标签">主机标签</a></li>
          <li><a href="/docs/rancher/v1.6/zh/hosts/#主机调度地址">主机调度地址</a></li>
          <li><a href="/docs/rancher/v1.6/zh/hosts/#在代理后的主机">在代理后的主机</a></li>
          <li><a href="/docs/rancher/v1.6/zh/hosts/custom/">添加自定义主机</a></li>
          <li>
              <a href="#">添加云主机<i class="pull-right fa fa-angle-down"></i></a>
              <ul>
                <li><a href="/docs/rancher/v1.6/zh/hosts/amazon/">添加Amazon EC2主机</a></li>
                <li><a href="/docs/rancher/v1.6/zh/hosts/azure/">添加Azure主机</a></li>
                <li><a href="/docs/rancher/v1.6/zh/hosts/digitalocean/">添加DigitalOcean主机</a></li>
                <li><a href="/docs/rancher/v1.6/zh/hosts/exoscale/">添加Exoscale主机</a></li>
                <li><a href="/docs/rancher/v1.6/zh/hosts/packet/">添加Packet主机</a></li>
                <li><a href="/docs/rancher/v1.6/zh/hosts/rackspace/">添加Rackspace主机</a></li>
                <li><a href="/docs/rancher/v1.6/zh/hosts/other/">添加其他云服务商的主机</a></li>
              </ul>
          </li>
          <li><a href="/docs/rancher/v1.6/zh/hosts/#访问云提供商的主机">访问云提供商的主机</a></li>
          <li><a href="/docs/rancher/v1.6/zh/hosts/#在rancher内删除主机">删除主机</a></li>
        </ul>
    </li>
    <li>
      <a href="#">镜像仓库<i class="pull-right fa fa-angle-down"></i></a>
      <ul>
        <li><a href="/docs/rancher/v1.6/zh/environments/registries/">镜像库</a></li>
        <li><a href="/docs/rancher/v1.6/zh/environments/registries/#不安全的镜像库">不安全的镜像库</a></li>
        <li><a href="/docs/rancher/v1.6/zh/environments/registries/#自签名证书">自签名证书</a></li>
        <li><a href="/docs/rancher/v1.6/zh/environments/registries/#使用亚马逊的ecr镜像库">使用亚马逊的ECR镜像库</a></li>
        <li><a href="/docs/rancher/v1.6/zh/environments/registries/#使用google容器镜像仓库">使用Google容器镜像仓库</a></li>
        <li><a href="/docs/rancher/v1.6/zh/environments/registries/#更改默认的镜像库">更改默认的镜像库</a></li>
        <li><a href="/docs/rancher/v1.6/zh/environments/registries/#限制镜像库的使用">限制镜像库的使用</a></li>
      </ul>
    </li>
    <li><a href="/docs/rancher/v1.6/zh/environments/certificates/">证书</a></li>
    <li>
      <a href="#">系统服务<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
              <li><a href="/docs/rancher/v1.6/zh/rancher-services/">基础设施服务</a></li>
              <li><a href="/docs/rancher/v1.6/zh/rancher-services/networking/">网络</a></li>
              <li><a href="/docs/rancher/v1.6/zh/rancher-services/network-policy/">网络策略</a></li>
              <li><a href="/docs/rancher/v1.6/zh/rancher-services/load-balancer">负载均衡器</a></li>
              <li><a href="/docs/rancher/v1.6/zh/rancher-services/dns-service/">DNS服务</a></li>
              <li><a href="/docs/rancher/v1.6/zh/rancher-services/metadata-service/">Metadata服务</a></li>
              <li>
                  <a href="#">存储服务<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/zh/rancher-services/storage-service/">存储服务</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/rancher-services/storage-service/rancher-nfs/">Rancher NFS</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/rancher-services/storage-service/rancher-ebs/">Rancher EBS</a></li>
                  </ul>
              </li>
              <li>
                  <a href="#">调度服务<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/zh/rancher-services/scheduler/">调度器</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/rancher-services/scheduler/#多ip主机调度">多IP主机调度</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/rancher-services/scheduler/#基于资源约束的调度">基于资源约束的调度</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/rancher-services/scheduler/#在主机上调度指定服务">在主机上调度指定服务</a></li>
                  </ul>
              </li>
              <li><a href="/docs/rancher/v1.6/zh/rancher-services/audit-log/">审计日志</a></li>
              <li><a href="/docs/rancher/v1.6/zh/rancher-services/service-accounts/">服务账号</a></li>
           </ul>
    </li>
    <li>
          <a href="#">Cattle<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
                <li><a href="/docs/rancher/v1.6/zh/cattle/stacks/">应用</a></li>
                <li><a href="/docs/rancher/v1.6/zh/cattle/adding-services/">服务</a></li>
                <li><a href="/docs/rancher/v1.6/zh/cattle/volumes/">卷</a></li>
                <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/">负载均衡</a></li>
                <li>
                    <a href="#">在UI中配置负载均衡<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#如何在ui上新增一个负载均衡">添加负载均衡</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#服务规则">服务规则</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#选择器规则">选择器规则</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#ssl会话终止">SSL会话终止</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#负载均衡的会话粘性">负载均衡的会话粘性</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#自定义haproxycfg">自定义HAProxy配置</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#标签调度负载均衡">标签调度负载均衡</a></li>
                      </ul>
                </li>
                <li>
                    <a href="#">在CLI和Compose中配置负载均衡<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#用rancher-compose-添加负载均衡">用Rancher Compose 添加负载均衡</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#源端口">源端口</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#端口规则">端口规则</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#证书">证书</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#自定义配置">自定义HAProxy配置</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#会话粘性策略">会话粘性策略</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#load-balancer-example-l7">七层负载均衡示例</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#内部负载均衡例子">内部负载均衡示例</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/#ssl会话终止-example">SSL会话终止示例</a></li>
                      </ul>
                </li>
                <li><a href="/docs/rancher/v1.6/zh/cattle/adding-external-services/">外部服务</a></li>
                <li><a href="/docs/rancher/v1.6/zh/cattle/adding-service-alias/">服务别名</a></li>
                <li><a href="/docs/rancher/v1.6/zh/cattle/health-checks/">健康检查</a></li>
                <li>
                    <a href="#">调度服务<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/scheduling/">调度</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/scheduling/#在ui中添加标签">在UI中设置调度规则</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/scheduling/#在rancher-compose中添加标签">在Rancher Compose中设置调度规则</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/scheduling/#调度标签表">调度标签表</a></li>
                    </ul>
                </li>
                <li><a href="/docs/rancher/v1.6/zh/cattle/upgrading/">升级服务</a></li>
                <li><a href="/docs/rancher/v1.6/zh/cattle/internal-dns-service/">Cattle环境中的内部DNS服务</a></li>
                <li><a href="/docs/rancher/v1.6/zh/cattle/external-dns-service/">外部DNS服务</a></li>
                <li>
                    <a href="#">Rancher-Compose<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/rancher-compose/">Rancher Compose</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/rancher-compose/commands/">指令与参数</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/rancher-compose/environment-interpolation/">环境插值</a></li>
                        <li><a href="/docs/rancher/v1.6/zh/cattle/rancher-compose/build/">使用AWS S3构建镜像</a></li>
                    </ul>
                </li>
                <li><a href="/docs/rancher/v1.6/zh/cattle/secrets/">密文 - 实验性的</a></li>
                <li><a href="/docs/rancher/v1.6/zh/cattle/webhook-service/">Webhooks</a></li>
                <li><a href="/docs/rancher/v1.6/zh/cattle/labels/">标签</a></li>
          </ul>
    </li>
    <li>
          <a href="#">Kubernetes<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
              <li><a href="/docs/rancher/v1.6/zh/kubernetes/">启动Kubernetes</a></li>
              <li><a href="/docs/rancher/v1.6/zh/kubernetes/resiliency-planes/">弹性平面</a></li>
              <li><a href="/docs/rancher/v1.6/zh/kubernetes/providers/">Cloud Providers</a></li>
              <li><a href="/docs/rancher/v1.6/zh/kubernetes/private-registry/">私有镜像仓库</a></li>
              <li><a href="/docs/rancher/v1.6/zh/kubernetes/rbac/">RBAC</a></li>
              <li><a href="/docs/rancher/v1.6/zh/kubernetes/disaster-recovery/">灾难恢复</a></li>
              <li><a href="/docs/rancher/v1.6/zh/kubernetes/backups/">备份</a></li>
              <li><a href="/docs/rancher/v1.6/zh/kubernetes/storage/">持久化存储</a></li>
              <li>
                  <a href="#">插件支持<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/addons/">插件支持</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/addons/#helm">Helm</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/addons/#skydns">SkyDNS</a></li>
                  </ul>
              </li>
              <li>
                  <a href="#">Ingress支持与配置<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/ingress/">Ingress支持</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/ingress/#基于主机路由配置-ingress-资源">基于主机路由配置Ingress资源</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/ingress/#使用基于路径的路由配置ingress资源">使用基于路径的路由配置Ingress资源</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/ingress/#示例两个负载均衡器使用交替的端口">多个负载均衡器使用不同的端口</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/ingress/#示例使用tls">使用 TLS</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/ingress/#禁用http">禁用HTTP</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/ingress/#示例用户定制">示例用户定制</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/ingress/#示例在所有主机上运行负载均衡器">所有主机运行负载均衡器</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/ingress/#示例在特定主机上运行负载均衡器">特定主机运行负载均衡器</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/ingress/#例将流量导向同一主机上的不同容器">将流量导向同一主机上的不同容器</a></li>
                      <li><a href="/docs/rancher/v1.6/zh/kubernetes/ingress/#示例在同一主机上对容器的流量进行优先级排序">在同一主机上对容器的流量进行优先级排序</a></li>
                  </ul>
              </li>
              <li><a href="/docs/rancher/v1.6/zh/kubernetes/upgrading/">升级Kubernetes</a></li>
              <li><a href="/docs/rancher/v1.6/zh/kubernetes/deleting/">删除Kubernetes</a></li>

          </ul>
    </li>
    <li><a href="/docs/rancher/v1.6/zh/mesos/">Mesos</a></li>
    <li><a href="/docs/rancher/v1.6/zh/swarm/">Swarm - 实验性的 </a></li>
    <li><a href="/docs/rancher/v1.6/zh/windows/">Windows - 实验性的</a></li>
    <li><a href="/docs/rancher/v1.6/zh/native-docker/">以原生Docker命令行的形式使用Rancher</a></li>
    <li>
            <a href="#">应用商店<i class="pull-right fa fa-angle-down"></i></a>
            <ul>
                <li><a href="/docs/rancher/v1.6/zh/catalog/">应用商店</a></li>
                <li><a href="/docs/rancher/v1.6/zh/catalog/private-catalog/">创建私有应用商店</a></li>
            </ul>
        </li>
    <li><a href="#">Rancher命令行<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
            <li><a href="/docs/rancher/v1.6/zh/cli/">Rancher命令行</a></li>
            <li><a href="/docs/rancher/v1.6/zh/cli/commands/">命令和选项</a></li>
            <li><a href="/docs/rancher/v1.6/zh/cli/variable-interpolation/">变量替换</a></li>
        </ul>
    </li>
    <li><a href="/docs/rancher/v1.6/en/api/v2-beta/">API文档</a></li>
    <li><a href="/docs/rancher/v1.6/zh/contributing/">Rancher社区贡献</a></li>
    <li>
        <a href="#">常见问题<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
            <li><a href="/docs/rancher/v1.6/zh/faqs/server/">Rancher Server的常见问题</a></li>
            <li><a href="/docs/rancher/v1.6/zh/faqs/agents/">Rancher Agent的常见问题</a></li>
            <li><a href="/docs/rancher/v1.6/zh/faqs/troubleshooting/">常见的故障排查与修复方法</a></li>
        </ul>
    </li>
    <li>
        <a href="#" class="btn-docs">历史文档<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
            <li><a href="/docs/rancher/v1.5/zh/">Rancher v1.5</a></li>
            <li><a href="/docs/rancher/v1.4/zh/">Rancher v1.4</a></li>
            <li><a href="/docs/rancher/v1.3/zh/">Rancher v1.3</a></li>
            <li><a href="/docs/rancher/v1.2/zh/">Rancher v1.2</a></li>
            <li><a href="/docs/rancher/v1.1/zh/">Rancher v1.1</a></li>
            <li><a href="/docs/rancher/v1.0/en/">Rancher v1.0</a></li>
        </ul>
    </li>
</ul>

</div>
<div class="col span-9">
    <div class="content-container">
        <h2 id="metadata-">Metadata 服务</h2>
<hr />

<p>Rancher通过基础设施中的Metadata服务为服务和容器提供数据。这些数据用来管理运行中的docker实例。这些数据可以通过调用基于HTTP的API来访问。这些数据包括创建容器，服务时的静态数据，也包括运行时数据，例如：在同一个服务里的其他容器的相关信息。</p>

<p>通过Rancher的Metadata服务，你可以进到任何使用Rancher托管网络的容器的命令行中，并查看运行在Rancher中的容器的信息。通过Metadata服务你可以获取容器，服务，容器所在的应用，容器所在的主机。Metadata是JSON格式的。</p>

<p>有多种方式可以将容器运行在Rancher托管网络中。Rancher网络的原理详见<a href="/docs/rancher/v1.6/zh/rancher-services/networking">网络相关文档</a>。</p>

<h3 id="metadata">如何获取Metadata</h3>

<p>通过Rancher UI，你可以通过容器的下拉菜单的<strong>执行命令行</strong>进入运行命令界面。在鼠标悬停在容器上时，会显示容器名和右侧的下拉菜单。</p>

<p>你可以通过curl命令获取metadata信息。</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># If curl is not installed, install it</span>
<span class="gp">$ </span>apt-get install curl
<span class="c"># Basic curl command to obtain a plaintext response</span>
<span class="gp">$ </span>curl http://rancher-metadata/&lt;version&gt;/&lt;path&gt;
</code></pre>
</div>
<p>curl请求的路径取决于你想要获取的metadata信息和格式。</p>

<table>
  <thead>
    <tr>
      <th>Metadata</th>
      <th>路径</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>容器</td>
      <td><code class="highlighter-rouge">self/container</code></td>
      <td>提供运行命令的容器的metadata信息</td>
    </tr>
    <tr>
      <td>容器所在服务</td>
      <td><code class="highlighter-rouge">self/service</code></td>
      <td>提供运行命令的容器对应服务的metadata信息</td>
    </tr>
    <tr>
      <td>容器所在应用</td>
      <td><code class="highlighter-rouge">self/stack</code></td>
      <td>提供运行命令的容器对应应用的metadata信息</td>
    </tr>
    <tr>
      <td>容器所在主机</td>
      <td><code class="highlighter-rouge">self/host</code></td>
      <td>提供运行命令的容器对应主机的metadata信息</td>
    </tr>
    <tr>
      <td>其他容器</td>
      <td><code class="highlighter-rouge">containers</code></td>
      <td>提供所有容器的metadata信息。在纯文本格式时，提供了带上索引序号的所有容器。在JSON格式，提供了所有容器的所有metadata信息。使用序号或者名字。都可以获取指定容器的metadata信息。</td>
    </tr>
    <tr>
      <td>其他服务</td>
      <td><code class="highlighter-rouge">services</code></td>
      <td>提供了所有服务的metadata信息。在纯文本格式时，提供了带上索引序号的所有服务。在JSON格式，提供了所有服务的所有metadata信息。在路径中使用序号或者名字，都可以获取指定服务的metadata信息。当访问容器详细信息时，在V1 (<code class="highlighter-rouge">2015-07-25</code>)只返回容器名称，但是在V2 (<code class="highlighter-rouge">2015-12-19</code>)，容器实例也会返回。</td>
    </tr>
    <tr>
      <td>其他应用</td>
      <td><code class="highlighter-rouge">stacks/&lt;stack-name&gt;</code></td>
      <td>提供了所有应用的metadata信息。在纯文本格式，提供了带上索引序号的所有应用。在JSON格式，提供了所有应用的所有metadata信息。使用序号或者名字。都可以获取指定容器的metadata信息。在路径中使用序号或者名字，都可以获取指定应用的metadata信息。当访问container详细信息时，在V1 (<code class="highlighter-rouge">2015-07-25</code>)只返回容器名称，但是在V2 (<code class="highlighter-rouge">2015-12-19</code>)，容器实例也会返回。</td>
    </tr>
  </tbody>
</table>

<h3 id="metadata-1">Metadata的版本</h3>

<p>在<code class="highlighter-rouge">curl</code>命令中，我们强烈建议使用确定的版本号，但是你也可以选者<code class="highlighter-rouge">latest</code>。</p>

<blockquote>
  <p><strong>注意：</strong> 因为<code class="highlighter-rouge">latest</code>版本会包含最新的代码变动，各个版本的返回的数据可能不同，需要确认是否和你之前的代码能够兼容。</p>
</blockquote>

<p>metadata的版本是基于日期的。</p>

<table>
  <thead>
    <tr>
      <th>Version Reference</th>
      <th>Version</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>V2</td>
      <td>2015-12-19</td>
    </tr>
    <tr>
      <td>V1</td>
      <td>2015-07-25</td>
    </tr>
  </tbody>
</table>

<h4 id="section">版本变化</h4>

<h5 id="v1-vs-v2">V1 vs. V2</h5>

<p>当通过http请求访问路径 <code class="highlighter-rouge">/services/&lt;service-name&gt;/containers</code>或者<code class="highlighter-rouge">/stacks/&lt;stack-name&gt;/services/&lt;service-name&gt;/containers</code>时, V1 返回容器名称，V2返回容器实例。更多详细信息在V2 metadata服务中提供。</p>

<h5 id="section-1">范例</h5>

<p>在Rancher中，名为<code class="highlighter-rouge">foostack</code>的应用包含一个有三个容器的服务 <code class="highlighter-rouge">barservice</code>。</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># 在V1只返回service的container names</span>
<span class="gp">$ </span>curl --header <span class="s1">'Accept: application/json'</span> <span class="s1">'http://rancher-metadata/2015-07-25/services/barservice/containers'</span>
<span class="o">[</span><span class="s2">"foostack_barservice_1"</span>, <span class="s2">"foostack_barservice_2"</span>, <span class="s2">"foostack_barservice_1"</span><span class="o">]</span>

<span class="c"># 在V2中返回service的container objects</span>
<span class="gp">$ </span>curl --header <span class="s1">'Accept: application/json'</span> <span class="s1">'http://rancher-metadata/2015-12-19/services/barservice/containers'</span>
<span class="o">[{</span><span class="s2">"create_index"</span>:1, <span class="s2">"health_state"</span>:null,<span class="s2">"host_uuid"</span>:...
...
<span class="c"># 获取service中所有容器的metadata信息</span>
...
...<span class="o">}]</span>

<span class="c"># 在V2，可以获取指定的container object</span>
<span class="gp">$ </span>curl --header <span class="s1">'Accept: application/json'</span> <span class="s1">'http://rancher-metadata/2015-12-19/services/barservice/containers/foostack_barservice_1'</span>
<span class="o">[{</span><span class="s2">"create_index"</span>:1, <span class="s2">"health_state"</span>:null,<span class="s2">"host_uuid"</span>:...
...
<span class="c"># 获取service中所有容器的metadata信息</span>
...
...<span class="o">}]</span>

<span class="c"># 通过路径 /stacks/&lt;service-name&gt;，可以访问services和containers</span>

<span class="c"># 使用V1只返回service的container names</span>
<span class="gp">$ </span>curl --header <span class="s1">'Accept: application/json'</span> <span class="s1">'http://rancher-metadata/2015-07-25/stacks/foostack/services/barservice/containers'</span>
<span class="o">[</span><span class="s2">"foostack_barservice_1"</span>, <span class="s2">"foostack_barservice_2"</span>, <span class="s2">"foostack_barservice_1"</span><span class="o">]</span>

<span class="c"># 使用V2返回service的container objects</span>
<span class="gp">$ </span>curl --header <span class="s1">'Accept: application/json'</span> <span class="s1">'http://rancher-metadata/2015-12-19/stacks/foostack/services/barservice/containers'</span>
<span class="o">[{</span><span class="s2">"create_index"</span>:1, <span class="s2">"health_state"</span>:null,<span class="s2">"host_uuid"</span>:...
...
<span class="c"># 获取service中所有容器的metadata信息</span>
...
...<span class="o">}]</span>
</code></pre>
</div>

<h3 id="vs-json">纯文本 vs JSON</h3>

<p>Metadata返回有纯文本和JSON两种格式，根据需要选择相应格式.</p>

<h4 id="section-2">纯文本</h4>

<p>通过curl命令，会获得请求路径的纯文本格式返回。你可以通过从第一层路径开始，层层推进，找到你需要的信息。</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl <span class="s1">'http://rancher-metadata/2015-12-19/self/container'</span>
create_index
dns/
dns_search/
external_id
health_check_hosts/
health_state
host_uuid
hostname
ips/
labels/
memory_reservation
milli_cpu_reservation
name
network_from_container_uuid
network_uuid
ports/
primary_ip
primary_mac_address
service_index
service_name
stack_name
stack_uuid
start_count
state
system
uuid
<span class="gp">$ </span>curl <span class="s1">'http://rancher-metadata/2015-12-19/self/container/name'</span>
<span class="c"># Note: Curl 不会返回新的行，只有一个数据时返回会输出在同一行</span>
Default_Example_1<span class="nv">$root</span>@&lt;container_id&gt;
<span class="gp">$ </span>curl <span class="s1">'http://rancher-metadata/2015-12-19/self/container/label/io.rancher.stack.name'</span>
Default<span class="nv">$root</span>@&lt;container_id&gt;
<span class="c"># Arrays可以通过序号或者名字访问</span>
<span class="gp">$ </span>curl <span class="s1">'http://rancher-metadata/2015-12-19/services'</span>
<span class="nv">0</span><span class="o">=</span>Example
<span class="c"># 使用序号或者名字</span>
<span class="gp">$ </span>curl <span class="s1">'http://rancher-metadata/2015-12-19/services/0'</span>
<span class="gp">$ </span>curl <span class="s1">'http://rancher-metadata/2015-12-19/services/Example'</span>
</code></pre>
</div>

<h4 id="json">JSON</h4>

<p>JSON格式的返回可以通过在curl命令中增加header <code class="highlighter-rouge">Accept: application/json</code></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl --header <span class="s1">'Accept: application/json'</span> <span class="s1">'http://rancher-metadata/2015-12-19/self/container'</span>
<span class="gp">$ </span>curl --header <span class="s1">'Accept: application/json'</span> <span class="s1">'http://rancher-metadata/2015-12-19/self/stack'</span>
<span class="c"># 获取stack中另一个service的信息</span>
<span class="gp">$ </span>curl --header <span class="s1">'Accept: application/json'</span> <span class="s1">'http://rancher-metadata/2015-12-19/services/&lt;service-name&gt;'</span>
</code></pre>
</div>

<h3 id="metadata-2">Metadata属性</h3>

<h4 id="section-3">容器</h4>

<table>
  <thead>
    <tr>
      <th>属性</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">create_index</code></td>
      <td>容器启动的序号 例如 2 代表的是服务中启动的第二个容器。注意: Create_index不会被重用。 如果你的服务包含两个容器，删除了第二个容器，下一个启动的容器的<code class="highlighter-rouge">create_index</code>会是3，即使服务中只包含2个容器</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">dns</code></td>
      <td>容器的DNS服务器。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">dns_search</code></td>
      <td>容器的搜索域。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">external_id</code></td>
      <td>在主机上的Docker容器ID。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">health_check_hosts</code></td>
      <td>列出运行健康检查的主机的的UUIDs。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">health_state</code></td>
      <td>开启健康检查的容器的健康状态 <a href="/docs/rancher/v1.6/zh/cattle/health-checks/">健康检查</a>。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">host_uuid</code></td>
      <td>Rancher Server分配给主机的唯一标识。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">hostname</code></td>
      <td>容器的hostname。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">ips</code></td>
      <td>支持多NIC时的IP列表</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">labels</code></td>
      <td><a href="/docs/rancher/v1.6/zh/cattle/scheduling/#labels">容器标签</a>列表。格式为<code class="highlighter-rouge">key</code>:<code class="highlighter-rouge">value</code>。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">memory_reservation</code></td>
      <td>容器可以使用内存的软限制。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">milli_cpu_reservation</code></td>
      <td>容器可以使用CPU的软限制，值为正整数，1代表1/1000CPU。所以，1000 代表1个CPU，500代表半个CPU。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">name</code></td>
      <td>容器的名字。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">network_from_container_uuid</code></td>
      <td>容器网络来源的容器UUID。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">network_uuid</code></td>
      <td>Rancher分配的网络唯一标识</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">ports</code></td>
      <td>列出<a href="/docs/rancher/v1.6/zh/cattle/adding-services/#port-mapping">容器使用的端口</a>。格式为： <code class="highlighter-rouge">hostIP:publicIP:privateIP[/protocol]</code>.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">primary_ip</code></td>
      <td>容器IP</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">primary_mac_address</code></td>
      <td>容器的MAC地址</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">service_index</code></td>
      <td>服务中容器名称的最后一个数字</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">service_name</code></td>
      <td>服务名称(如果存在)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">stack_name</code></td>
      <td>服务所在的应用的名称(如果存在)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">stack_uuid</code></td>
      <td>Rancher分配的应用的唯一标识</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">start_count</code></td>
      <td>容器启动的次数</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">state</code></td>
      <td>容器状态</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">system</code></td>
      <td>容器是否是Rancher<a href="/docs/rancher/v1.6/zh/rancher-services/">基础设施服务</a></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">uuid</code></td>
      <td>Rancher分配容器唯一标识</td>
    </tr>
  </tbody>
</table>

<h4 id="section-4">服务</h4>

<table>
  <thead>
    <tr>
      <th>属性</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">containers</code></td>
      <td>列出服务中的容器名称</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">create_index</code></td>
      <td>服务中最后启动的容器的序号 例如 2代表的是服务中启动的第二个容器。注意: Create_index不会被重用。 如果你的服务包含2个容器，删除了第二个容器，下一个启动的容器的<code class="highlighter-rouge">create_index</code>会是3，即使服务中只包含2个容器</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">expose</code></td>
      <td>对主机暴露，但是不对外暴露的端口</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">external_ips</code></td>
      <td><a href="/docs/rancher/v1.6/zh/cattle/adding-external-services/">内部服务</a>的IP列表</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">fqdn</code></td>
      <td>服务的全称域名</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">health_check</code></td>
      <td>服务的<a href="/docs/rancher/v1.6/zh/cattle/health-checks/">健康检查配置</a></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">hostname</code></td>
      <td><a href="/docs/rancher/v1.6/zh/cattle/adding-external-services/">内部服务</a>的CNAME</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">kind</code></td>
      <td>Rancher的服务类型</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">labels</code></td>
      <td><a href="/docs/rancher/v1.6/zh/cattle/scheduling/#labels">服务标签</a>列表，格式为 <code class="highlighter-rouge">key:value</code>.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">lb_config</code></td>
      <td><a href="/docs/rancher/v1.6/zh/cattle/adding-load-balancers/">负载均衡</a>的配置</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">links</code></td>
      <td>列出服务的链接，格式为<code class="highlighter-rouge">stack_name/service∂_name:service_alias</code>. <code class="highlighter-rouge">links</code>(例如 <code class="highlighter-rouge">stack_name/service_name</code> 获取所有链接)根据返回的<code class="highlighter-rouge">service_alias</code>,获取进一步的详细信息。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">metadata</code></td>
      <td><a href="/docs/rancher/v1.6/zh/rancher-services/metadata-service/#adding-user-metadata-to-a-service">用户添加的metadata</a></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">name</code></td>
      <td>服务名称</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">ports</code></td>
      <td><a href="/docs/rancher/v1.6/zh/cattle/adding-services/#port-mapping">服务使用的端口</a>。格式<code class="highlighter-rouge">hostIP:publicIP:privateIP[/protocol]</code>.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">primary_service_name</code></td>
      <td>主服务名，如果有从服务</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">scale</code></td>
      <td>服务中容器的规模数量</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">sidekicks</code></td>
      <td><a href="/docs/rancher/v1.6/zh/cattle/adding-services/#sidekick-服务">从容器</a>服务的名称列表</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">stack_name</code></td>
      <td>服务所在的应用的名称</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">stack_uuid</code></td>
      <td>Rancher分配的应用的唯一标识</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">system</code></td>
      <td>是否是<a href="/docs/rancher/v1.6/zh/rancher-services/">基础设施服务</a></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">uuid</code></td>
      <td>Rancher分配的服务的唯一标识</td>
    </tr>
  </tbody>
</table>

<h4 id="section-5">应用</h4>

<table>
  <thead>
    <tr>
      <th>属性</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">environment_name</code></td>
      <td>应用所在的<a href="/docs/rancher/v1.6/zh/environments/">环境</a>的名字</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">environment_uuid</code></td>
      <td>Rancher分配的环境的唯一标识</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">name</code></td>
      <td><a href="/docs/rancher/v1.6/zh/cattle/stacks/">应用</a>名称</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">services</code></td>
      <td>应用中的服务列表</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">system</code></td>
      <td>应用是否为<a href="/docs/rancher/v1.6/zh/rancher-services/">基础设施服务</a></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">uuid</code></td>
      <td>Rancher分配的应用的唯一标识</td>
    </tr>
  </tbody>
</table>

<h4 id="section-6">主机</h4>

<table>
  <thead>
    <tr>
      <th>属性</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">agent_ip</code></td>
      <td>Rancher Agent的IP，例如 <code class="highlighter-rouge">CATTLE_AGENT_IP</code>环境变量值。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">hostname</code></td>
      <td><a href="/docs/rancher/v1.6/zh/hosts/">主机</a>的名称</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">labels</code></td>
      <td><a href="/docs/rancher/v1.6/zh/hosts/#主机标签">主机标签</a>列表。格式为<code class="highlighter-rouge">key:value</code>.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">local_storage_mb</code></td>
      <td>主机的存储大小，单位为MB</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">memory</code></td>
      <td>主机的内存大小，单位为MB</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">milli_cpu</code></td>
      <td>主机的CPU。数值为整数，1代表1/1000的cpu。所以，1000代表1 CPU.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">name</code></td>
      <td><a href="/docs/rancher/v1.6/zh/hosts/">主机</a>的名称</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">uuid</code></td>
      <td>Rancher分配的主机的唯一标识</td>
    </tr>
  </tbody>
</table>

<h3 id="metadata-3">为服务添加用户自定义Metadata</h3>

<p>Rancher支持为服务添加用户metadata。现在只支持通过<a href="/docs/rancher/v1.6/zh/cattle/rancher-compose/">Rancher Compose</a>添加，metadata是<code class="highlighter-rouge">rancher-compose.yml</code>的一部分。<code class="highlighter-rouge">metadata</code>key对应的部分，yaml会被转化成在metadata-service中使用的JSON格式</p>

<h4 id="example-rancher-composeyml">Example <code class="highlighter-rouge">rancher-compose.yml</code></h4>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">service</span><span class="pi">:</span>
  <span class="c1"># Scale of service</span>
  <span class="s">scale</span><span class="pi">:</span> <span class="s">3</span>
  <span class="c1"># User added metadata</span>
  <span class="s">metadata</span><span class="pi">:</span>
    <span class="s">example</span><span class="pi">:</span>
      <span class="s">name</span><span class="pi">:</span> <span class="s">hello</span>
      <span class="s">value</span><span class="pi">:</span> <span class="s">world</span>
    <span class="s">example2</span><span class="pi">:</span>
      <span class="s">foo</span><span class="pi">:</span> <span class="s">bar</span>

</code></pre>
</div>

<p>服务启动后，可以使用metadata服务在<code class="highlighter-rouge">.../self/service/metadata</code>或者<code class="highlighter-rouge">.../services/&lt;service_id&gt;/metadata</code>看到metadata数据</p>

<h4 id="json-1">按照JSON格式查询</h4>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl --header <span class="s1">'Accept: application/json'</span> <span class="s1">'http://rancher-metadata/latest/self/service/metadata'</span>
<span class="o">{</span><span class="s2">"example"</span>:<span class="o">{</span><span class="s2">"name"</span>:<span class="s2">"hello"</span>,<span class="s2">"value"</span>:<span class="s2">"world"</span><span class="o">}</span>,<span class="s2">"example2"</span>:<span class="o">{</span><span class="s2">"foo"</span>:<span class="s2">"bar"</span><span class="o">}}</span>

</code></pre>
</div>

<h4 id="section-7">按照纯文本格式查询</h4>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl <span class="s1">'http://rancher-metadata/latest/self/service/metadata'</span>
example/
<span class="gp">$ </span>curl <span class="s1">'http://rancher-metadata/latest/self/service/metadata/example'</span>
name
value
<span class="gp">$ </span>curl <span class="s1">'http://rancher-metadata/latest/self/service/metadata/example/name'</span>
<span class="c"># # Note: Curl 不会返回新的行，只有一个数据时返回会输出在同一行</span>
hello<span class="nv">$root</span>@&lt;container_id&gt;
</code></pre>
</div>

    </div>
</div>
</div>
</div>

<div class="row wrap">
<a class="btn btn-primary pull-right" href="https://github.com/rancher/rancher.github.io/tree/master/rancher/latest/zh/rancher-services/metadata-service/index.md">Edit this page <i class="fa fa-pencil"></i></a>
</div>

<footer class="clearfix">
  <div class="wrap">
    <div class=""><!--bottom footer-->
      <div class="row">
          <div class="col span-6">
              <ul id="menu-footer" class="list-inline">
                  <li id="menu-item-14151" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14151"><a title="About Rancher Labs" href="http://rancher.com/about/">About Rancher Labs</a></li>
                  <li id="menu-item-11352" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-11352"><a title="Contact" href="http://rancher.com/contact/">Contact</a></li>
                  <li id="menu-item-14152" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14152"><a title="Privacy" href="http://rancher.com/privacy/">Privacy</a></li>
                  <li id="menu-item-15635" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-15635"><a title="Careers" href="http://rancher.com/careers/">Careers</a></li>
                  
                  <li id="menu-item-14151" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14151"><a title="English Docs" href="https://rancher.com/docs/rancher/latest/en/">English Docs</a></li>
                  
              </ul>
              <p>Copyright &copy; 2014-2017 <a href="http://rancher.com">Rancher Labs</a>. All Rights Reserved.</p>
          </div>
          <div class="col span-6 text-right">
              <ul class="list-inline">
                  <li><a href="https://github.com/rancher/rancher" target="_blank"><img src="http://rancher.com/wp-content/themes/rancher-2016/assets/images/social-white-github.png" alt="Rancher Labs GitHub"></a></li>
                  <li><a href="https://twitter.com/Rancher_Labs" target="_blank"><img src="http://rancher.com/wp-content/themes/rancher-2016/assets/images/social-white-twitter.png" alt="Rancher Labs Twitter"></a></li>
                  <li><a href="https://slack.rancher.io/" target="_blank"><img src="http://rancher.com/wp-content/themes/rancher-2016/assets/images/social-white-slack.png" alt="Rancher Labs Slack"></a></li>
                  <li><a href="https://www.linkedin.com/groups/6977008/profile" target="_blank"><img src="http://rancher.com/wp-content/themes/rancher-2016/assets/images/social-white-linkedin.png" alt="Rancher Labs LinkedIn"></a></li>
                  <li><a href="https://www.facebook.com/rancherlabs/" target="_blank"><img src="http://rancher.com/wp-content/themes/rancher-2016/assets/images/social-white-fb.png" alt="Rancher Labs Facebook"></a></li>
              </ul>
          </div>
      </div>
    </div><!--bottom footer-->
    </div>
</footer>
<script src="/docs/vendor/jquery.js?t=2017-12-04 13:23:19 -0800"></script>
<script src="/docs/js/jquery.slicknav.min.js?t=2017-12-04 13:23:19 -0800"></script>
<script src="/docs/js/rancher-docs.js?t=2017-12-04 13:23:19 -0800"></script>
<!-- Start of Google Analytics -->
<script>
(function(i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
ga('create', 'UA-56382716-3', 'auto');
ga('send', 'pageview');
</script>
<!-- End of Google Analytics -->
<!-- Start of Async HubSpot Analytics Code -->
<script type="text/javascript">
(function(d, s, i, r) {
    if (d.getElementById(i)) { return; }
    var n = d.createElement(s),
        e = d.getElementsByTagName(s)[0];
    n.id = i;
    n.src = '//js.hs-analytics.net/analytics/' + (Math.ceil(new Date() / r) * r) + '/468859.js';
    e.parentNode.insertBefore(n, e);
})(document, "script", "hs-analytics", 300000);
</script>
<!-- End of Async HubSpot Analytics Code -->
</body>

</html>

